2023-09-16 00:33:48: INFO: Total NaN values in each row.
2023-09-16 00:33:48: INFO: NOTE: I am not imputing TARGET_LOSS_AMT because this is only NaN when the person did not default.
2023-09-16 00:33:48: INFO: 
TARGET_BAD_FLAG       0
TARGET_LOSS_AMT    4771
LOAN                  0
MORTDUE             518
VALUE               112
REASON              252
JOB                 279
YOJ                 515
DEROG               708
DELINQ              580
CLAGE               308
NINQ                510
CLNO                222
DEBTINC            1267
2023-09-16 00:33:48: INFO: Median of each numerical column grouped by job and reason of loan. I will impute NaNs with these values.
2023-09-16 00:33:48: INFO: 
                 TARGET_BAD_FLAG  TARGET_LOSS_AMT     LOAN     MORTDUE     VALUE    YOJ  DEROG  DELINQ       CLAGE  NINQ  CLNO    DEBTINC
REASON  JOB                                                                                                                              
DebtCon Mgr                  0.0          14360.0  19450.0   76600.000   99025.5   8.00    0.0     0.0  175.570979   1.0  23.0  36.290354
        Office               0.0          13453.0  17900.0   63744.000   90810.5   5.00    0.0     0.0  167.657981   1.0  22.0  36.099281
        Other                0.0          12124.0  18000.0   54653.000   77519.0   8.00    0.0     0.0  152.202235   1.0  19.0  35.730559
        ProfExe              0.0          15237.0  18500.0   83149.500  113083.5   8.00    0.0     0.0  190.800000   1.0  25.0  33.591086
        Sales                0.0          16656.0  15200.0   74392.500   87446.5   4.00    0.0     0.0  141.268671   0.0  23.0  35.033102
        Self                 0.0          19324.0  23400.0  101250.000  125252.0   5.00    0.0     0.0  178.951539   1.0  24.0  34.554127
        NaN                  0.0          14756.0  11100.0   59701.500   80037.0   5.00    0.0     0.0  129.896035   1.0  16.0  31.626822
HomeImp Mgr                  0.0           6533.5  13250.0   74013.000  102377.5   8.00    0.0     0.0  162.637297   0.0  21.0  33.200548
        Office               0.0           5817.0  12000.0   62200.000   80147.0  10.00    0.0     0.0  175.082704   0.0  17.5  35.949877
        Other                0.0           4572.0  10800.0   53812.500   73319.0   7.00    0.0     0.0  168.666667   0.0  15.0  34.485533
        ProfExe              0.0           6934.0  14900.0   82889.500  107442.5   7.00    0.0     0.0  177.854846   0.0  22.0  32.870335
        Sales                0.0           3870.0   5500.0   70793.000   70735.0   4.00    1.0     0.0  156.625882   0.0  23.0  40.442569
        Self                 0.0          17239.0  24000.0   78943.500  167020.0   7.00    0.0     0.0  192.226177   1.0  21.0  35.871959
        NaN                  0.0          12251.5  21900.0   85337.000  100147.0   8.00    0.0     0.0  142.147140   0.0  13.0  31.203189
NaN     Mgr                  0.0          14283.0  20000.0  111000.000  168708.0  13.00    0.0     4.0  249.242763   1.0  27.0  32.698229
        Office               0.0              NaN  15500.0   25751.000   44461.0   2.00    0.0     0.0  211.033333   0.0  16.0  37.816428
        Other                0.0          11471.0  16100.0   67371.305   95085.0  12.00    0.0     0.0  246.918710   0.0  19.0  31.183363
        ProfExe              0.0          10107.5  18500.0   62772.000   90031.0   6.50    0.0     0.0  108.136393   1.0  17.5  27.740432
        Self                 1.0          28095.0  27700.0   61396.000  111627.0   5.00    0.0     1.0  101.466667   1.0  28.0  84.613889
        NaN                  0.0           5312.0  13300.0   47811.000   72583.0   0.95    0.0     0.0  118.976063   0.0   0.0  23.988913
2023-09-16 00:33:48: INFO: Impute missing values START.
2023-09-16 00:33:48: INFO: Impute missing categorical values to 'Unknwon'.
2023-09-16 00:33:48: INFO: Add new column for flag and imputed numbers.
2023-09-16 00:33:48: INFO: The NaNs will be imputed by the median of per Job and Reason.
2023-09-16 00:33:48: INFO: The original imputed columns will be deleted.
2023-09-16 00:33:48: INFO: Impute missing values END.
2023-09-16 00:33:48: INFO: First 5 observations of the imputed data
2023-09-16 00:33:48: INFO: 
                         0           1           2       3          4
TARGET_BAD_FLAG          1           1           1       1          0
TARGET_LOSS_AMT      641.0      1109.0       767.0  1425.0        NaN
LOAN                  1100        1300        1500    1500       1700
MORTDUE            25860.0     70053.0     13500.0     NaN    97800.0
VALUE              39025.0     68400.0     16700.0     NaN   112000.0
REASON             HomeImp     HomeImp     HomeImp     NaN    HomeImp
JOB                  Other       Other       Other     NaN     Office
YOJ                   10.5         7.0         4.0     NaN        3.0
DEROG                  0.0         0.0         0.0     NaN        0.0
DELINQ                 0.0         2.0         0.0     NaN        0.0
CLAGE            94.366667  121.833333  149.466667     NaN  93.333333
NINQ                   1.0         0.0         1.0     NaN        0.0
CLNO                   9.0        14.0        10.0     NaN       14.0
DEBTINC                NaN         NaN         NaN     NaN        NaN
2023-09-16 00:33:48: INFO: Confirming there are no NaNs (except the intentionally left TARGET_LOSS_AMT.)
2023-09-16 00:33:48: INFO: 
TARGET_BAD_FLAG       0
TARGET_LOSS_AMT    4771
LOAN                  0
REASON                0
JOB                   0
M_MORTDUE             0
IMP_MORTDUE           0
M_VALUE               0
IMP_VALUE             0
M_YOJ                 0
IMP_YOJ               0
M_DEROG               0
IMP_DEROG             0
M_DELINQ              0
IMP_DELINQ            0
M_CLAGE               0
IMP_CLAGE             0
M_NINQ                0
IMP_NINQ              0
M_CLNO                0
IMP_CLNO              0
M_DEBTINC             0
IMP_DEBTINC           0
2023-09-16 00:33:48: INFO: Creating dummy variables for categorical columns
2023-09-16 00:33:48: INFO: Completed creating dummy variables
2023-09-16 00:33:48: INFO: First 5 observations of the data with dummy variables
2023-09-16 00:33:48: INFO: 
   TARGET_BAD_FLAG  TARGET_LOSS_AMT  LOAN  M_MORTDUE  IMP_MORTDUE  M_VALUE  IMP_VALUE  M_YOJ  IMP_YOJ  M_DEROG  IMP_DEROG  M_DELINQ  IMP_DELINQ  M_CLAGE   IMP_CLAGE  M_NINQ  IMP_NINQ  M_CLNO  IMP_CLNO  M_DEBTINC  IMP_DEBTINC  z_REASON_DebtCon  z_REASON_HomeImp  z_JOB_Mgr  z_JOB_Office  z_JOB_Other  z_JOB_ProfExe  z_JOB_Sales  z_JOB_Self
0                1            641.0  1100          0      25860.0        0    39025.0      0    10.50        0        0.0         0         0.0        0   94.366667       0       1.0       0       9.0          1    34.485533                 0                 1          0             0            1              0            0           0
1                1           1109.0  1300          0      70053.0        0    68400.0      0     7.00        0        0.0         0         2.0        0  121.833333       0       0.0       0      14.0          1    34.485533                 0                 1          0             0            1              0            0           0
2                1            767.0  1500          0      13500.0        0    16700.0      0     4.00        0        0.0         0         0.0        0  149.466667       0       1.0       0      10.0          1    34.485533                 0                 1          0             0            1              0            0           0
3                1           1425.0  1500          1      47811.0        1    72583.0      1     0.95        1        0.0         1         0.0        1  118.976063       1       0.0       1       0.0          1    23.988913                 0                 0          0             0            0              0            0           0
4                0              NaN  1700          0      97800.0        0   112000.0      0     3.00        0        0.0         0         0.0        0   93.333333       0       0.0       0      14.0          1    35.949877                 0                 1          0             1            0              0            0           0
2023-09-16 00:33:48: INFO: LOSS AMOUNT statistics
2023-09-16 00:33:48: INFO: 
count     1189.000000
mean     12118.188394
std       7574.544843
min        224.000000
25%       5639.000000
50%      11003.000000
75%      17634.000000
max      25000.000000
2023-09-16 00:33:48: INFO: Data Split
2023-09-16 00:33:48: INFO: FLAG DATA
2023-09-16 00:33:48: INFO: TRAINING = (4768, 27)
2023-09-16 00:33:48: INFO: TEST = (1192, 27)
2023-09-16 00:33:48: INFO: LOSS AMOUNT DATA
2023-09-16 00:33:48: INFO: TRAINING = (951, 2)
2023-09-16 00:33:48: INFO: TEST = (238, 2)
2023-09-16 00:33:48: INFO: 
       TARGET_BAD_FLAG  TARGET_LOSS_AMT
count            951.0       951.000000
mean               1.0     12254.549947
std                0.0      7625.029926
min                1.0       224.000000
25%                1.0      5781.000000
50%                1.0     11122.000000
75%                1.0     18082.000000
max                1.0     25000.000000
2023-09-16 00:33:48: INFO: 
       TARGET_BAD_FLAG  TARGET_LOSS_AMT
count            238.0       238.000000
mean               1.0     11573.315126
std                0.0      7359.835410
min                1.0       320.000000
25%                1.0      5025.500000
50%                1.0     10390.000000
75%                1.0     16489.500000
max                1.0     25000.000000
2023-09-16 00:33:48: INFO: Decision Tree Categorical
2023-09-16 00:33:48: INFO: Using Default Parameters for Decision Tree.
2023-09-16 00:33:48: INFO: Decision Tree Accuracy Train: 0.8867
2023-09-16 00:33:48: INFO: Decision Tree Accuracy Test:: 0.8826
2023-09-16 00:33:48: INFO: Decision Tree AUC Train: 0.84
2023-09-16 00:33:48: INFO: Decision Tree AUC Test: 0.83
2023-09-16 00:33:48: INFO: Decision Tree AUC Train Cross Validation Average: 0.84
2023-09-16 00:33:49: INFO: Important Variables
        Feature  Importance
17    M_DEBTINC    0.684915
18  IMP_DEBTINC    0.154356
10   IMP_DELINQ    0.067968
12    IMP_CLAGE    0.046233
3       M_VALUE    0.037610
7       M_DEROG    0.008917
2023-09-16 00:33:50: INFO: Saved viz file to: /Users/takeshisugiyama/Desktop/Home_Loan/img/2-tree-models//viz//Decition_Tree_Categorical_Default-Params_viz-1
2023-09-16 00:33:50: INFO: Decision Tree Regression
2023-09-16 00:33:50: INFO: Using Default Parameters for Decision Tree.
2023-09-16 00:33:50: INFO: Decision Tree MEAN Train: 12254.549947423764
2023-09-16 00:33:50: INFO: Decision Tree MEAN Test: 11573.31512605042
2023-09-16 00:33:50: INFO: Decision Tree RMSE Train: 3769.5466630483907
2023-09-16 00:33:50: INFO: Decision Tree RMSE Test: 4545.020719655776
2023-09-16 00:33:50: INFO: Decision Tree RMSE Train Cross Validation Average: 4012.28
2023-09-16 00:33:50: INFO: Important Variables
        Feature  Importance
0          LOAN    0.889160
18  IMP_DEBTINC    0.056861
16     IMP_CLNO    0.053979
2023-09-16 00:33:51: INFO: Saved viz file to: /Users/takeshisugiyama/Desktop/Home_Loan/img/2-tree-models//viz//Decition_Tree_Regression_Default-Params_viz-1
2023-09-16 00:33:51: INFO: Random Forest Categorical
2023-09-16 00:33:51: INFO: Using Default Parameters for Random Forest.
2023-09-16 00:33:51: INFO: Random Forest Accuracy Train: 0.8490
2023-09-16 00:33:51: INFO: Random Forest Accuracy Test:: 0.8322
2023-09-16 00:33:51: INFO: Random Forest AUC Train: 0.92
2023-09-16 00:33:51: INFO: Random Forest AUC Test: 0.90
2023-09-16 00:33:52: INFO: Random Forest AUC Train Cross Validation Average: 0.91
2023-09-16 00:33:59: INFO: Important Variables
             Feature  Importance
17         M_DEBTINC    0.419369
10        IMP_DELINQ    0.137118
18       IMP_DEBTINC    0.112429
3            M_VALUE    0.103614
8          IMP_DEROG    0.093825
12         IMP_CLAGE    0.034517
0               LOAN    0.026130
14          IMP_NINQ    0.017117
4          IMP_VALUE    0.013551
16          IMP_CLNO    0.011297
2        IMP_MORTDUE    0.006719
7            M_DEROG    0.005438
6            IMP_YOJ    0.005266
11           M_CLAGE    0.002465
19  z_REASON_DebtCon    0.001929
5              M_YOJ    0.001821
9           M_DELINQ    0.001685
23       z_JOB_Other    0.001107
25       z_JOB_Sales    0.001086
15            M_CLNO    0.001067
13            M_NINQ    0.000787
22      z_JOB_Office    0.000612
24     z_JOB_ProfExe    0.000531
20  z_REASON_HomeImp    0.000368
1          M_MORTDUE    0.000094
21         z_JOB_Mgr    0.000057
2023-09-16 00:33:59: INFO: Random Forest Regression
2023-09-16 00:33:59: INFO: Using Default Parameters for Random Forest.
2023-09-16 00:34:00: INFO: Random Forest MEAN Train: 12254.549947423764
2023-09-16 00:34:00: INFO: Random Forest MEAN Test: 11573.31512605042
2023-09-16 00:34:01: INFO: Random Forest RMSE Train: 3377.961581982611
2023-09-16 00:34:01: INFO: Random Forest RMSE Test: 3913.1520070685615
2023-09-16 00:34:01: INFO: Random Forest RMSE Train Cross Validation Average: 3551.22
2023-09-16 00:34:01: INFO: Important Variables
        Feature  Importance
0          LOAN    0.872863
16     IMP_CLNO    0.054425
18  IMP_DEBTINC    0.051393
17    M_DEBTINC    0.018225
10   IMP_DELINQ    0.001918
12    IMP_CLAGE    0.000381
6       IMP_YOJ    0.000339
8     IMP_DEROG    0.000333
14     IMP_NINQ    0.000125
2023-09-16 00:34:01: INFO: Gradient Boosting Categorical
2023-09-16 00:34:01: INFO: Using Default Parameters for Gradient Boosting.
2023-09-16 00:34:02: INFO: Gradient Boosting Accuracy Train: 0.9241
2023-09-16 00:34:02: INFO: Gradient Boosting Accuracy Test:: 0.8968
2023-09-16 00:34:02: INFO: Gradient Boosting AUC Train: 0.96
2023-09-16 00:34:02: INFO: Gradient Boosting AUC Test: 0.93
2023-09-16 00:34:05: INFO: Gradient Boosting AUC Train Cross Validation Average: 0.94
2023-09-16 00:34:11: INFO: Important Variables
             Feature  Importance
17         M_DEBTINC    0.470040
18       IMP_DEBTINC    0.133917
10        IMP_DELINQ    0.087491
12         IMP_CLAGE    0.062730
8          IMP_DEROG    0.041840
3            M_VALUE    0.041424
4          IMP_VALUE    0.033387
16          IMP_CLNO    0.022117
0               LOAN    0.021824
14          IMP_NINQ    0.012546
7            M_DEROG    0.012186
2        IMP_MORTDUE    0.012112
6            IMP_YOJ    0.010768
5              M_YOJ    0.009865
11           M_CLAGE    0.007744
25       z_JOB_Sales    0.005794
23       z_JOB_Other    0.004245
15            M_CLNO    0.002350
22      z_JOB_Office    0.002232
26        z_JOB_Self    0.001750
20  z_REASON_HomeImp    0.001281
13            M_NINQ    0.000918
9           M_DELINQ    0.000704
24     z_JOB_ProfExe    0.000520
1          M_MORTDUE    0.000191
21         z_JOB_Mgr    0.000022
2023-09-16 00:34:11: INFO: Gradient Boosting Regression
2023-09-16 00:34:11: INFO: Using Default Parameters for Gradient Boosting.
2023-09-16 00:34:11: INFO: Gradient Boosting MEAN Train: 12254.549947423764
2023-09-16 00:34:11: INFO: Gradient Boosting MEAN Test: 11573.31512605042
2023-09-16 00:34:12: INFO: Gradient Boosting RMSE Train: 1124.6376049451671
2023-09-16 00:34:12: INFO: Gradient Boosting RMSE Test: 1932.4401038481599
2023-09-16 00:34:12: INFO: Gradient Boosting RMSE Train Cross Validation Average: 2032.29
2023-09-16 00:34:12: INFO: Important Variables
             Feature  Importance
0               LOAN    0.709656
16          IMP_CLNO    0.099734
17         M_DEBTINC    0.058351
18       IMP_DEBTINC    0.045743
12         IMP_CLAGE    0.033385
10        IMP_DELINQ    0.024396
20  z_REASON_HomeImp    0.010847
6            IMP_YOJ    0.006100
8          IMP_DEROG    0.003621
2        IMP_MORTDUE    0.002809
4          IMP_VALUE    0.002427
25       z_JOB_Sales    0.000755
9           M_DELINQ    0.000599
14          IMP_NINQ    0.000533
26        z_JOB_Self    0.000339
19  z_REASON_DebtCon    0.000123
22      z_JOB_Office    0.000110
5              M_YOJ    0.000096
15            M_CLNO    0.000090
3            M_VALUE    0.000081
23       z_JOB_Other    0.000075
1          M_MORTDUE    0.000071
7            M_DEROG    0.000060
